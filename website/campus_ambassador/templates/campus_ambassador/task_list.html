{% extends 'campus_ambassador/base.html' %}
{% load static %}
{% block title %}
Home
{% endblock %}
{% block head %}

<link rel="stylesheet" href="{% static 'css/campus_ambassador/task_list.css' %}">
{% endblock %}
{% block content %}
<div class="view-box">
    {% if is_ambassador %}
        <div class="grid place-items-start  pt-[15vh] gap-4 md:gap-8">
            <div class="bg-slate-200/70 text-slate-900 px-3 py-4 rounded-lg w-full">
                <!-- Task section -->
                {% if status.code == 201 %}
                    <h2>Current Task : {{amb.get_current_task.number}}</h2>
                    <h3 class="font-semibold">{{amb.get_current_task.number}} | {{amb.get_current_task.title}}</h3>
                    <p>{{amb.get_current_task.description}}</p>
                    <div class="hidden"><h4 id="secs-left">{{secs_left}}</h4></div>
                    <div class="">
                        <h1>Time Left: </h1>
                        
                        <ul class="flex gap-2 justify-around w-fit mx-auto">
                            <li class="bg-stone-800 text-stone-50 font-semibold p-3 rounded-md" id="out_days">00</li>
                            <li class="bg-stone-800 text-stone-50 font-semibold p-3 rounded-md" id="out_hrs">00</li>
                            <li class="bg-stone-800 text-stone-50 font-semibold p-3 rounded-md" id="out_mins">00</li>
                            <li class="bg-stone-800 text-stone-50 font-semibold p-3 rounded-md" id="out_secs">00</li>
                        </ul>
                    </div>
                    {% for subtask in amb.get_all_current_subtasks %}
                        <div class="">
                            <h3 class="font-semibold pl-8">{{subtask.task.number}}.{{subtask.number}} | {{subtask.title}}</h3>
                            <p class="pl-8">{{subtask.description}}</p>
                            <div class="w-full my-4 flex flex-wrap gap-4 justify-center">
                                <a class="subtask-submit-link mx-auto px-4 py-2 font-semibold bg-gradient-to-l from-orange-600 to-yellow-600 text-slate-50 rounded-full" href="{{subtask.submission_url}}">Submit Task Now</a>
                            </div>
                        </div>
                    {% endfor %}
                {% elif status.code == 202 %}
                    <h1>{{status.msg}}</h1>
                {% elif status.code == 204 %}
                    <h2>{{status.msg}}</h2>
                {% endif %}
            </div>
            <div class="w-full my-8">
                <h2 class="font-semibold text-lg">All tasks</h2>
                <br>
                <div class="flex flex-col gap-4 text-slate-800">
                    {% for task in tasks_list %}
                        <div class="bg-slate-200/70 rounded-lg p-3">
                            <h2>{{task.number}} | {{task.title}}e</h2>
                            <h3>{{task.description}}</h3>
                            {% for st in task.subtasks %}
                                <div class="pl-4 pt-2">
                                    <h2>{{task.number}}.{{st.number}} | {{st.title}}</h2>
                                    <p>{{st.description}}</p>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                    <!-- Final Pagination -->
                    <center>
                        <div class="paginator">

                            {%if tasks_list.has_previous %} {# whether the previous page exists #}

                            <a href="?page_num={{tasks_list.previous_page_number}}" class="paginator-btn"> &lt;</a>
                            {# link to the prev page #}
                            {% else %}
                            <a href="#" class="paginator-btn hidden">
                                <</a> {# link to the prev page #} {% endif %} &ensp; <!-- <span id="current-page">
                                    {{ambassadors.number}}</span> {# the current page number #} -->
                                    {%if tasks_list.has_next %} {# whether the next page exists #}
                                    <a href="?page_num={{tasks_list.next_page_number}}" class="paginator-btn"> ></a>
                                    {# link to the next page #}
                                    {% else %}
                                    <a href="#" class="paginator-btn hidden"> ></a> {# link to the prev page #}
                                    {% endif %}
                        </div>
                    </center>
                </div>
              </div>
        </div>
    {% elif is_moderator %}
        <div class="w-full pt-[15vh]">
            <h2 class="font-semibold text-lg">All tasks</h2>
            <br>
            <div class="flex flex-col gap-4 text-slate-800">
                {% for task in tasks_list %}
                    <div class="bg-slate-200/70 rounded-lg p-3">
                        <h2>{{task.number}} | {{task.title}}e</h2>
                        <h3>{{task.description}}</h3>
                        {% for st in task.subtasks %}
                            <div class="pl-4 pt-2">
                                <h2>{{task.number}}.{{st.number}} | {{st.title}}</h2>
                                <p>{{st.description}}</p>
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
                <!-- Final Pagination -->
                <center>
                    <div class="paginator">

                        {%if tasks_list.has_previous %} {# whether the previous page exists #}

                        <a href="?page_num={{tasks_list.previous_page_number}}" class="paginator-btn"> &lt;</a>
                        {# link to the prev page #}
                        {% else %}
                        <a href="#" class="paginator-btn hidden">
                            <</a> {# link to the prev page #} {% endif %} &ensp; <!-- <span id="current-page">
                                {{ambassadors.number}}</span> {# the current page number #} -->
                                {%if tasks_list.has_next %} {# whether the next page exists #}
                                <a href="?page_num={{tasks_list.next_page_number}}" class="paginator-btn"> ></a>
                                {# link to the next page #}
                                {% else %}
                                <a href="#" class="paginator-btn hidden"> ></a> {# link to the prev page #}
                                {% endif %}
                    </div>
                </center>
            </div>
        </div>
    {% endif %}
    
</div>
<script src="{% static 'js/campus_ambassador/task_swiper.js' %}"></script>
<script src="{% static 'js/campus_ambassador/timer.js' %}"></script>
{% endblock %}